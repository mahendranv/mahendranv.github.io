<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="GraphQL backend — authorization &amp; authentication" /><meta property="og:locale" content="en" /><meta name="description" content="GraphQL authorization &amp; authentication using Aspectj and Filters" /><meta property="og:description" content="GraphQL authorization &amp; authentication using Aspectj and Filters" /><link rel="canonical" href="https://mahendranv.github.io/posts/2021-05-31-gql-auth/" /><meta property="og:url" content="https://mahendranv.github.io/posts/2021-05-31-gql-auth/" /><meta property="og:site_name" content="Mahendran" /><meta property="og:image" content="https://mahendranv.github.io/assets/covers/gql_auth.jpg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-05-31T00:00:00+05:30" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://mahendranv.github.io/assets/covers/gql_auth.jpg" /><meta property="twitter:title" content="GraphQL backend — authorization &amp; authentication" /><meta name="twitter:site" content="@mahevelai" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"image":"https://mahendranv.github.io/assets/covers/gql_auth.jpg","headline":"GraphQL backend — authorization &amp; authentication","dateModified":"2021-06-02T22:38:30+05:30","datePublished":"2021-05-31T00:00:00+05:30","description":"GraphQL authorization &amp; authentication using Aspectj and Filters","url":"https://mahendranv.github.io/posts/2021-05-31-gql-auth/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://mahendranv.github.io/posts/2021-05-31-gql-auth/"},"@context":"https://schema.org"}</script><title>GraphQL backend — authorization & authentication | Mahendran</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Mahendran"><meta name="application-name" content="Mahendran"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/614333/01be055d-c668-46ba-8f7b-54065256c70d.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Mahendran</a></div><div class="site-subtitle font-italic">Android | Kotlin | Springboot | DGS</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/series/" class="nav-link"> <i class="fa-fw fas fas fa-list-ol ml-xl-3 mr-xl-3 unloaded"></i> <span>SERIES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/mahendranv" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/mahevelai" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://dev.to/mahendranv" aria-label="dev.to" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-dev"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>GraphQL backend — authorization & authentication</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>GraphQL backend — authorization & authentication</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Mahendran Vadivalagan </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, May 31, 2021, 12:00 AM +0530" >May 31<i class="unloaded">2021-05-31T00:00:00+05:30</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Wed, Jun 2, 2021, 10:38 PM +0530" >Jun 2<i class="unloaded">2021-06-02T22:38:30+05:30</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1619 words">8 min read</span></div></div><div class="post-content"><h2 id="background">Background</h2><p>In any system where users interacting with each other, authorization &amp; authentication are the key elements that controls what each user can do. To read more on authentication and authorization try <a href="https://en.wikipedia.org/wiki/Role-based_access_control">RBAC</a>. To demonstrate the usecases, I present few roles and resources below. This is an e-commerce website.</p><div class="table-wrapper"><table><thead><tr><th>Role<th>Remarks<tbody><tr><td>Visitor<td>There is no session yet, user can enroll in the system to become Buyer/Seller<tr><td>Buyer<td>Buyer can place order and update his address-profile<tr><td>Seller<td>Seller can add product and update order status once Buyer place an order</table></div><p>For simplicity resources are just few GraphQL mutations and users are hardcoded in the system. You can get the sample project source at <a href="https://github.com/mahendranv/graphql-auth-dummy">github</a>.</p><p>Let’s start with graphql schema and move towards authentication.</p><ol id="markdown-toc"><li><a href="#background" id="markdown-toc-background">Background</a><li><a href="#-code-it" id="markdown-toc--code-it">🧑‍💻 Code it</a><ol><li><a href="#ground-preparation" id="markdown-toc-ground-preparation">Ground preparation</a><li><a href="#components-to-know" id="markdown-toc-components-to-know">Components to know</a><ol><li><a href="#filters" id="markdown-toc-filters">Filters</a><li><a href="#requestcontextholder" id="markdown-toc-requestcontextholder">RequestContextHolder</a><li><a href="#requestmanager" id="markdown-toc-requestmanager">RequestManager</a><li><a href="#aspect-aop" id="markdown-toc-aspect-aop">Aspect [AOP]</a></ol><li><a href="#requestmanager-1" id="markdown-toc-requestmanager-1">RequestManager</a><li><a href="#request-filter" id="markdown-toc-request-filter">Request filter</a><li><a href="#custom-annotations" id="markdown-toc-custom-annotations">Custom annotations</a><li><a href="#aspect" id="markdown-toc-aspect">Aspect</a></ol><li><a href="#-run-it" id="markdown-toc--run-it">🚀 Run it</a><ol><li><a href="#why-do-we-need-method-level-control" id="markdown-toc-why-do-we-need-method-level-control">Why do we need method level control?</a></ol><li><a href="#future-scope" id="markdown-toc-future-scope">Future scope</a><li><a href="#-resources" id="markdown-toc--resources">📖 Resources</a></ol><h2 id="-code-it">🧑‍💻 Code it</h2><h3 id="ground-preparation">Ground preparation</h3><p>First define a schema with few queries that meant for each role. They just return a string when each mutation is invoked. Catch is each user need specific auth token to access the resource.</p><div class="language-graphql highlighter-rouge"><div class="code-header"> <span text-data=" GraphQL "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="n">Mutation</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">registerUser</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="w">
        </span><span class="n">placeOrder</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="w">
        </span><span class="n">addProduct</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>And the respective DGSComponent that expose the resource looks like this:</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>
<span class="nd">@DgsComponent</span>
<span class="kd">class</span> <span class="nc">DummyResource</span> <span class="p">{</span>

    <span class="nd">@DgsMutation</span>
    <span class="k">fun</span> <span class="nf">registerUser</span><span class="p">():</span> <span class="nc">String</span> <span class="p">=</span> <span class="s">"dummy-member-id"</span>

    <span class="nd">@DgsMutation</span>
    <span class="k">fun</span> <span class="nf">placeOrder</span><span class="p">():</span> <span class="nc">String</span> <span class="p">=</span> <span class="s">"dummy-order-id"</span>

    <span class="nd">@DgsMutation</span>
    <span class="k">fun</span> <span class="nf">addProduct</span><span class="p">():</span> <span class="nc">String</span> <span class="p">=</span> <span class="s">"dummy-product-id"</span>

<span class="p">}</span>

</pre></table></code></div></div><p>In a typical system, each of them will need input, since we focus on roles and how do we protect each mutation from other roles, all other parts are omitted for brevity. We expect the system to throw error when authentication fails. Below is the <code class="language-plaintext highlighter-rouge">DummyUserService</code> class where system identifies user role given an auth-token.</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>
<span class="nd">@Service</span>
<span class="kd">class</span> <span class="nc">DummyUserService</span> <span class="p">{</span>

    <span class="kd">val</span> <span class="py">sessions</span> <span class="p">=</span> <span class="nf">mapOf</span><span class="p">(</span>
        <span class="s">"token-buyer"</span> <span class="n">to</span> <span class="nc">Roles</span><span class="p">.</span><span class="nc">BUYER</span><span class="p">,</span>
        <span class="s">"token-seller"</span> <span class="n">to</span> <span class="nc">Roles</span><span class="p">.</span><span class="nc">SELLER</span>
    <span class="p">)</span>

    <span class="k">fun</span> <span class="nf">identifyRole</span><span class="p">(</span><span class="n">token</span><span class="p">:</span> <span class="nc">String</span><span class="p">?):</span> <span class="nc">Roles</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">sessions</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">?:</span> <span class="nc">Roles</span><span class="p">.</span><span class="nc">VISITOR</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">enum</span> <span class="kd">class</span> <span class="nc">Roles</span> <span class="p">{</span>
    <span class="nc">VISITOR</span><span class="p">,</span>
    <span class="nc">BUYER</span><span class="p">,</span>
    <span class="nc">SELLER</span>
<span class="p">}</span>

</pre></table></code></div></div><p>Above wraps up the overall, setup for roles and resources. Let’s wire up authentication.</p><h3 id="components-to-know">Components to know</h3><p>We’ll use following components to set up authentication. They are born of springboot &amp; aspectj and not specific to graphql. So, even RestController can benefit using the below ones. Oneliner on each piece before start implementing them. How do they interact is illustrated in below diagram.</p><p><img data-proofer-ignore data-src="/assets/img/2021-05-31-23-41-35.png" alt="" /></p><p>Components in orange will be created by us. Green one is provided by springboot. And the blue wrapper is generated by aspectj for us.</p><h4 id="filters">Filters</h4><p>Filters are the requst interceptors. They can process any incoming servlet request before it reaches the resolver (in our case the mutation). We’ll use <code class="language-plaintext highlighter-rouge">OncePerRequestFilter</code> to augment our incoming request with Role related information.</p><h4 id="requestcontextholder">RequestContextHolder</h4><p><code class="language-plaintext highlighter-rouge">RequestContextHolder</code> can hold session related information (user id, token, role) for a servlet request. However, we own the logic to build a session context. At any point of time, this can be accessed within the system to identify session.</p><h4 id="requestmanager">RequestManager</h4><p>This is created by us to wrap <code class="language-plaintext highlighter-rouge">RequestContextHolder</code> and provide nice interface to other components in play. Business logic to build a session context is done here.</p><h4 id="aspect-aop">Aspect [AOP]</h4><p>Aspect oriented programming is a programming paradigm where any component can be augmented to provide common functionalities, so that each controller (mutation) doesn’t have to hold any repeating business logic (authentication). This is achieved by creating proxy classes around the target class. Head over to <a href="https://en.wikipedia.org/wiki/Aspect-oriented_programming">wiki</a> to know more about this.</p><p>That covers each component and it’s role in authentication. Let’s code to have further clarity. I’ll build bottom up to so that we’ll know the dependency between each.</p><h3 id="requestmanager-1">RequestManager</h3><p>Requst manager reads header from incoming request and store it to <code class="language-plaintext highlighter-rouge">RequestContextHolder</code>. It uses <code class="language-plaintext highlighter-rouge">UserService</code> created in Ground preparation section. It also hosts few helper methods to ease up session data retrieval in latter parts. Code should be self-explanatory with inline comments.</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre>
<span class="nd">@Component</span>
<span class="kd">class</span> <span class="nc">DummyRequestManager</span> <span class="p">{</span>

    <span class="nd">@Autowired</span>
    <span class="k">private</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">userService</span><span class="p">:</span> <span class="nc">DummyUserService</span>

    <span class="c1">// Save the session info per request. Retrieve it throughout the request</span>
    <span class="k">fun</span> <span class="nf">saveSession</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="nc">HttpServletRequest</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Retrieve auth token from request - if any</span>
        <span class="kd">val</span> <span class="py">token</span><span class="p">:</span> <span class="nc">String</span><span class="p">?</span> <span class="p">=</span> <span class="n">request</span><span class="p">.</span><span class="nf">getHeader</span><span class="p">(</span><span class="nc">HEADER_TOKEN</span><span class="p">)</span>

        <span class="c1">// Identify role</span>
        <span class="kd">val</span> <span class="py">role</span> <span class="p">=</span> <span class="n">userService</span><span class="p">.</span><span class="nf">identifyRole</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>

        <span class="c1">// attribute the request with session. This will be available throughout the session</span>
        <span class="n">request</span><span class="p">.</span><span class="nf">setAttribute</span><span class="p">(</span>
            <span class="nc">KEY_SESSION</span><span class="p">,</span> <span class="nc">DummySession</span><span class="p">(</span>
                <span class="n">role</span> <span class="p">=</span> <span class="n">role</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// A non-null guaranteed session. Everyone has a role here.</span>
    <span class="k">fun</span> <span class="nf">getSession</span><span class="p">():</span> <span class="nc">DummySession</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">session</span> <span class="p">=</span> <span class="nc">RequestContextHolder</span>
            <span class="p">.</span><span class="nf">getRequestAttributes</span><span class="p">()</span><span class="o">!!</span><span class="p">.</span><span class="nf">getAttribute</span><span class="p">(</span><span class="nc">KEY_SESSION</span><span class="p">,</span> <span class="nc">RequestAttributes</span><span class="p">.</span><span class="nc">SCOPE_REQUEST</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">session</span> <span class="k">as</span> <span class="nc">DummySession</span>
    <span class="p">}</span>

    <span class="cm">/**
     * Convenience method to retrieve role
     */</span>
    <span class="k">fun</span> <span class="nf">getUserRole</span><span class="p">():</span> <span class="nc">Roles</span> <span class="p">=</span> <span class="nf">getSession</span><span class="p">().</span><span class="n">role</span>

    <span class="k">companion</span> <span class="k">object</span> <span class="p">{</span>
        <span class="k">private</span> <span class="k">const</span> <span class="kd">val</span> <span class="py">KEY_SESSION</span> <span class="p">=</span> <span class="s">"userSession"</span>
        <span class="k">private</span> <span class="k">const</span> <span class="kd">val</span> <span class="py">HEADER_TOKEN</span> <span class="p">=</span> <span class="s">"x-auth-token"</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">data class</span> <span class="nc">DummySession</span><span class="p">(</span> <span class="kd">val</span> <span class="py">role</span><span class="p">:</span> <span class="nc">Roles</span><span class="p">)</span>

</pre></table></code></div></div><h3 id="request-filter">Request filter</h3><p>Request filters are the interceptors for any request. Logging and session creation are the common usecase for this component. Let’s create a <code class="language-plaintext highlighter-rouge">DummyRequestFilter</code> and invoke request manager to create session.</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre>
<span class="cm">/**
 * Interceptor that executed once per http request
 */</span>
<span class="nd">@Component</span>
<span class="kd">class</span> <span class="nc">DummyRequestFilter</span> <span class="p">:</span> <span class="nc">OncePerRequestFilter</span><span class="p">()</span> <span class="p">{</span>

    <span class="nd">@Autowired</span>
    <span class="k">private</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">requestManager</span><span class="p">:</span> <span class="nc">DummyRequestManager</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">doFilterInternal</span><span class="p">(</span>
        <span class="n">request</span><span class="p">:</span> <span class="nc">HttpServletRequest</span><span class="p">,</span>
        <span class="n">response</span><span class="p">:</span> <span class="nc">HttpServletResponse</span><span class="p">,</span>
        <span class="n">filterChain</span><span class="p">:</span> <span class="nc">FilterChain</span>
    <span class="p">)</span> <span class="p">{</span>

        <span class="c1">// Feed the request to request manager for session preparation</span>
        <span class="n">requestManager</span><span class="p">.</span><span class="nf">saveSession</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

        <span class="c1">// Resume with request</span>
        <span class="n">filterChain</span><span class="p">.</span><span class="nf">doFilter</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

</pre></table></code></div></div><h3 id="custom-annotations">Custom annotations</h3><p>With above two pieces in place, we identified user role per request. Next is to retrict access for each mutation. Let’s create few annotations for each role.</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>
<span class="nd">@Retention</span><span class="p">(</span><span class="nc">AnnotationRetention</span><span class="p">.</span><span class="nc">RUNTIME</span><span class="p">)</span>
<span class="nd">@Target</span><span class="p">(</span><span class="nc">AnnotationTarget</span><span class="p">.</span><span class="nc">FUNCTION</span><span class="p">)</span>
<span class="k">annotation</span> <span class="kd">class</span> <span class="nc">BuyerOnly</span>

<span class="nd">@Retention</span><span class="p">(</span><span class="nc">AnnotationRetention</span><span class="p">.</span><span class="nc">RUNTIME</span><span class="p">)</span>
<span class="nd">@Target</span><span class="p">(</span><span class="nc">AnnotationTarget</span><span class="p">.</span><span class="nc">FUNCTION</span><span class="p">)</span>
<span class="k">annotation</span> <span class="kd">class</span> <span class="nc">SellerOnly</span>

<span class="nd">@Retention</span><span class="p">(</span><span class="nc">AnnotationRetention</span><span class="p">.</span><span class="nc">RUNTIME</span><span class="p">)</span>
<span class="nd">@Target</span><span class="p">(</span><span class="nc">AnnotationTarget</span><span class="p">.</span><span class="nc">FUNCTION</span><span class="p">)</span>
<span class="k">annotation</span> <span class="kd">class</span> <span class="nc">VisitorOnly</span>

</pre></table></code></div></div><p>Marking the territory for each user.</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>
<span class="nc">File</span><span class="p">:</span> <span class="s">"DummyResource.kt"</span>

<span class="nd">@DgsComponent</span>
<span class="kd">class</span> <span class="nc">DummyResource</span> <span class="p">{</span>

    <span class="nd">@VisitorOnly</span>
    <span class="nd">@DgsMutation</span>
    <span class="k">fun</span> <span class="nf">registerUser</span><span class="p">():</span> <span class="nc">String</span> <span class="p">=</span> <span class="s">"dummy-member-id"</span>

    <span class="nd">@BuyerOnly</span>
    <span class="nd">@DgsMutation</span>
    <span class="k">fun</span> <span class="nf">placeOrder</span><span class="p">():</span> <span class="nc">String</span> <span class="p">=</span> <span class="s">"dummy-order-id"</span>

    <span class="nd">@SellerOnly</span>
    <span class="nd">@DgsMutation</span>
    <span class="k">fun</span> <span class="nf">addProduct</span><span class="p">():</span> <span class="nc">String</span> <span class="p">=</span> <span class="s">"dummy-product-id"</span>

<span class="p">}</span>
</pre></table></code></div></div><h3 id="aspect">Aspect</h3><p>We have session and resource marked for each role. All that’s left is to read the annotation and role and authenticate requests. For this purpose, we have Aspects — aspects can run before-after-even around a <a href="https://en.wikipedia.org/wiki/Aspect-oriented_programming#Terminology">pointcut</a>. Here, pointcut refers to our mutation method — the safety net logic that we execute before mutation is called advice. Together they’re called aspect. So, our final piece “the aspect” is here.</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre>
<span class="nd">@Component</span>
<span class="nd">@Aspect</span>
<span class="kd">class</span> <span class="nc">DummyAspect</span> <span class="p">{</span>

    <span class="nd">@Autowired</span>
    <span class="k">private</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">requestManager</span><span class="p">:</span> <span class="nc">DummyRequestManager</span>

    <span class="nd">@Before</span><span class="p">(</span><span class="s">"@annotation(SellerOnly)"</span><span class="p">)</span>
    <span class="k">fun</span> <span class="nf">restrictSellerOnly</span><span class="p">(</span><span class="n">joinPoint</span><span class="p">:</span> <span class="nc">JoinPoint</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">role</span> <span class="p">=</span> <span class="n">requestManager</span><span class="p">.</span><span class="nf">getUserRole</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">role</span> <span class="p">!=</span> <span class="nc">Roles</span><span class="p">.</span><span class="nc">SELLER</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="nc">GraphQLException</span><span class="p">(</span><span class="s">"This operation is specific to Seller accounts"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nd">@Before</span><span class="p">(</span><span class="s">"@annotation(BuyerOnly)"</span><span class="p">)</span>
    <span class="k">fun</span> <span class="nf">restrictBuyerOnly</span><span class="p">(</span><span class="n">joinPoint</span><span class="p">:</span> <span class="nc">JoinPoint</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">role</span> <span class="p">=</span> <span class="n">requestManager</span><span class="p">.</span><span class="nf">getUserRole</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">role</span> <span class="p">!=</span> <span class="nc">Roles</span><span class="p">.</span><span class="nc">BUYER</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="nc">GraphQLException</span><span class="p">(</span><span class="s">"This operation is specific to Buyer accounts"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nd">@Before</span><span class="p">(</span><span class="s">"@annotation(VisitorOnly)"</span><span class="p">)</span>
    <span class="k">fun</span> <span class="nf">restrictVisitorOnly</span><span class="p">(</span><span class="n">joinPoint</span><span class="p">:</span> <span class="nc">JoinPoint</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">role</span> <span class="p">=</span> <span class="n">requestManager</span><span class="p">.</span><span class="nf">getUserRole</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">role</span> <span class="p">!=</span> <span class="nc">Roles</span><span class="p">.</span><span class="nc">BUYER</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="nc">GraphQLException</span><span class="p">(</span><span class="s">"Please logout from existing session"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

</pre></table></code></div></div><p>That’s it.</p><h2 id="-run-it">🚀 Run it</h2><p>Try running the mutation in curl or graphiQL playground [http://localhost:8080/graphiql].</p><div class="language-json highlighter-rouge"><div class="code-header"> <span text-data=" Json "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="err">//</span><span class="w"> </span><span class="err">Seller</span><span class="w"> </span><span class="err">adds</span><span class="w"> </span><span class="err">product</span><span class="w"> </span><span class="err">succussfully</span><span class="w">

</span><span class="err">curl</span><span class="w"> </span><span class="err">'http://localhost:</span><span class="mi">8080</span><span class="err">/graphql'</span><span class="w"> </span><span class="err">\</span><span class="w">
  </span><span class="err">-H</span><span class="w"> </span><span class="err">'x-auth-token:</span><span class="w"> </span><span class="err">token-seller'</span><span class="w"> </span><span class="err">\</span><span class="w">
  </span><span class="err">-H</span><span class="w"> </span><span class="err">'Content-Type:</span><span class="w"> </span><span class="err">application/json'</span><span class="w"> </span><span class="err">\</span><span class="w">
  </span><span class="err">--data-raw</span><span class="w"> </span><span class="err">'</span><span class="p">{</span><span class="nl">"query"</span><span class="p">:</span><span class="s2">"mutation { addProduct }"</span><span class="p">,</span><span class="nl">"variables"</span><span class="p">:</span><span class="kc">null</span><span class="p">}</span><span class="err">'</span><span class="w"> </span><span class="err">\</span><span class="w">
  </span><span class="err">--compressed</span><span class="w">

</span><span class="p">{</span><span class="nl">"data"</span><span class="p">:{</span><span class="nl">"addProduct"</span><span class="p">:</span><span class="s2">"dummy-product-id"</span><span class="p">}}</span><span class="w">

</span></pre></table></code></div></div><div class="language-json highlighter-rouge"><div class="code-header"> <span text-data=" Json "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="err">//</span><span class="w"> </span><span class="err">Buyer</span><span class="w"> </span><span class="err">cannot</span><span class="w"> </span><span class="err">add</span><span class="w"> </span><span class="err">product</span><span class="w">

  </span><span class="err">curl</span><span class="w"> </span><span class="err">'http://localhost:</span><span class="mi">8080</span><span class="err">/graphql'</span><span class="w"> </span><span class="err">\</span><span class="w">
  </span><span class="err">-H</span><span class="w"> </span><span class="err">'x-auth-token:</span><span class="w"> </span><span class="err">token-buyer'</span><span class="w"> </span><span class="err">\</span><span class="w">
  </span><span class="err">-H</span><span class="w"> </span><span class="err">'Content-Type:</span><span class="w"> </span><span class="err">application/json'</span><span class="w"> </span><span class="err">\</span><span class="w">
  </span><span class="err">--data-raw</span><span class="w"> </span><span class="err">'</span><span class="p">{</span><span class="nl">"query"</span><span class="p">:</span><span class="s2">"mutation {</span><span class="se">\n</span><span class="s2">  </span><span class="se">\n</span><span class="s2">  addProduct</span><span class="se">\n</span><span class="s2">  </span><span class="se">\n</span><span class="s2">}"</span><span class="p">,</span><span class="nl">"variables"</span><span class="p">:</span><span class="kc">null</span><span class="p">}</span><span class="err">'</span><span class="w"> </span><span class="err">\</span><span class="w">
  </span><span class="err">--compressed</span><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nl">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"This operation is specific to Seller accounts"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"locations"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
      </span><span class="nl">"extensions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"errorType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UNKNOWN"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"addProduct"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></pre></table></code></div></div><h3 id="why-do-we-need-method-level-control">Why do we need method level control?</h3><p>Following query is possible with graphql.</p><div class="language-graphql highlighter-rouge"><div class="code-header"> <span text-data=" GraphQL "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="w">
</span><span class="k">mutation</span><span class="w"> </span><span class="p">{</span><span class="w"> 
    </span><span class="n">addProduct</span><span class="w"> 
    </span><span class="n">placeOrder</span><span class="w"> 
</span><span class="p">}</span><span class="w">

</span><span class="c">### header</span><span class="w">
</span><span class="err">"x-auth-token":"token-seller"</span><span class="w">

</span></pre></table></code></div></div><p>In a single graphQL http-request you can stack up multiple operations. In such cases, only one operation fails while the other execute successfully. Pretty cool right 😎?.</p><div class="language-json highlighter-rouge"><div class="code-header"> <span text-data=" Json "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"This operation is specific to Buyer accounts"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"locations"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
      </span><span class="nl">"extensions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"errorType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UNKNOWN"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"addProduct"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dummy-product-id"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"placeOrder"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><h2 id="future-scope">Future scope</h2><p>With this scaffold we can build resources with granular control. With simple annotations added to each method, it is possible to restrict nested objects without modifying much to the business logic in resolvers.</p><p>For this example, we took <code class="language-plaintext highlighter-rouge">Role</code> in focus. Let’s say I need to create a resource specific to a user, like an address. I don’t have to (shouldn’t) pass in user-id in the input. It is cross verified against the token and available in session. A full context like user’s client/locale etc. will be availble to tailor perfect response.</p><p>In a reallife system, the userservice would be table query or federated service provider. For performance, the session information should be cached and remote calls must be avoided to get bit of performance boost.</p><h2 id="-resources">📖 Resources</h2><ol><li><a href="https://github.com/mahendranv/graphql-auth-dummy">Github repo</a><li><a href="https://en.wikipedia.org/wiki/Aspect-oriented_programming">Aspect oriented programming</a><li><a href="https://en.wikipedia.org/wiki/Role-based_access_control">Role Based Access Control</a></ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/graphql/'>GraphQL</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/graphql/" class="post-tag no-text-decoration" >graphql</a> <a href="/tags/springboot/" class="post-tag no-text-decoration" >springboot</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=GraphQL backend — authorization & authentication - Mahendran&url=https://mahendranv.github.io/posts/gql-auth/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=GraphQL backend — authorization & authentication - Mahendran&u=https://mahendranv.github.io/posts/gql-auth/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=GraphQL backend — authorization & authentication - Mahendran&url=https://mahendranv.github.io/posts/gql-auth/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/viewmodel-store/">Android — ViewModel factory and instantiation</a><li><a href="/posts/compose-shapes-gists/">I created few shapes in Jetpack compose / Gist included</a><li><a href="/posts/compose-shapes/">Jetpack compose - shape your views</a><li><a href="/posts/timer/">Android — Implementing LifecycleAwareTimer</a><li><a href="/posts/bon-apetit/">Hackerrank - bon-appetit problem solution in Kotlin</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/kotlin/">kotlin</a> <a class="post-tag" href="/tags/graphql/">graphql</a> <a class="post-tag" href="/tags/springboot/">springboot</a> <a class="post-tag" href="/tags/compose/">compose</a> <a class="post-tag" href="/tags/coding/">coding</a> <a class="post-tag" href="/tags/dribbble/">dribbble</a> <a class="post-tag" href="/tags/tools/">tools</a> <a class="post-tag" href="/tags/beginners/">beginners</a> <a class="post-tag" href="/tags/blog/">blog</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/gql-auth-401/"><div class="card-body"> <span class="timeago small" >Jun 1<i class="unloaded">2021-06-01T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>GraphQL backend — token expiry</h3><div class="text-muted small"><p> In the previous post we covered authentication and role management. However, it assumed any invalid session to be a visitor instead of throwing 401—Unauthorized client error. This post covers the t...</p></div></div></a></div><div class="card"> <a href="/posts/gql-simple-backend/"><div class="card-body"> <span class="timeago small" >May 17<i class="unloaded">2021-05-17T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>GraphQL - simple backend server - SpringBoot application</h3><div class="text-muted small"><p> In this post, I’ll cover how to create a simple GraphQL server with Springboot and Netflix DGS. DGS is chosen because you start with GraphQL schema and then build server side logic around it. P...</p></div></div></a></div><div class="card"> <a href="/posts/gql-delete-update/"><div class="card-body"> <span class="timeago small" >May 18<i class="unloaded">2021-05-18T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>GraphQL backend — update & delete</h3><div class="text-muted small"><p> In the first installment, I covered create and read operations to the Expense entity. Now let’s add few more operations ⇨ update and delete queries. Entire source code is available in github. For ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/L4-median/" class="btn btn-outline-primary" prompt="Older"><p>LeetCode — Median of Two Sorted Arrays</p></a> <a href="/posts/gql-auth-401/" class="btn btn-outline-primary" prompt="Newer"><p>GraphQL backend — token expiry</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/mahevelai">Mahendran Vadivalagan</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/kotlin/">kotlin</a> <a class="post-tag" href="/tags/graphql/">graphql</a> <a class="post-tag" href="/tags/springboot/">springboot</a> <a class="post-tag" href="/tags/compose/">compose</a> <a class="post-tag" href="/tags/coding/">coding</a> <a class="post-tag" href="/tags/dribbble/">dribbble</a> <a class="post-tag" href="/tags/tools/">tools</a> <a class="post-tag" href="/tags/beginners/">beginners</a> <a class="post-tag" href="/tags/blog/">blog</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://mahendranv.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
