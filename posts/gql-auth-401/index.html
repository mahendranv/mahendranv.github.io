<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="GraphQL backend ‚Äî token expiry" /><meta property="og:locale" content="en" /><meta name="description" content="GraphQL authorization ‚Äî token expiry" /><meta property="og:description" content="GraphQL authorization ‚Äî token expiry" /><link rel="canonical" href="https://mahendranv.github.io/posts/2021-06-01-gql-auth-401/" /><meta property="og:url" content="https://mahendranv.github.io/posts/2021-06-01-gql-auth-401/" /><meta property="og:site_name" content="Mahendran" /><meta property="og:image" content="https://mahendranv.github.io/assets/covers/gql_401.jpg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-06-01T00:00:00+05:30" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://mahendranv.github.io/assets/covers/gql_401.jpg" /><meta property="twitter:title" content="GraphQL backend ‚Äî token expiry" /><meta name="twitter:site" content="@mahevelai" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-06-02T22:38:30+05:30","datePublished":"2021-06-01T00:00:00+05:30","description":"GraphQL authorization ‚Äî token expiry","headline":"GraphQL backend ‚Äî token expiry","image":"https://mahendranv.github.io/assets/covers/gql_401.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://mahendranv.github.io/posts/2021-06-01-gql-auth-401/"},"url":"https://mahendranv.github.io/posts/2021-06-01-gql-auth-401/"}</script><title>GraphQL backend ‚Äî token expiry | Mahendran</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Mahendran"><meta name="application-name" content="Mahendran"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/614333/01be055d-c668-46ba-8f7b-54065256c70d.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Mahendran</a></div><div class="site-subtitle font-italic">Android | Kotlin | Springboot | DGS</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/series/" class="nav-link"> <i class="fa-fw fas fas fa-list-ol ml-xl-3 mr-xl-3 unloaded"></i> <span>SERIES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/mahendranv" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/mahevelai" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://dev.to/mahendranv" aria-label="dev.to" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-dev"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG ‚Ä∫ <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>GraphQL backend ‚Äî token expiry</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>GraphQL backend ‚Äî token expiry</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Mahendran Vadivalagan </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Jun 1, 2021, 12:00 AM +0530" >Jun 1, 2021<i class="unloaded">2021-06-01T00:00:00+05:30</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Wed, Jun 2, 2021, 10:38 PM +0530" >Jun 2, 2021<i class="unloaded">2021-06-02T22:38:30+05:30</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1261 words">7 min read</span></div></div><div class="post-content"><p>In the <a href="https://mahendranv.github.io/posts/2021-05-31-gql-auth/">previous post</a> we covered authentication and role management. However, it assumed any invalid session to be a visitor instead of throwing 401‚ÄîUnauthorized client error. This post covers the token expiry aspect of API call.</p><p>Let‚Äôs start with coding part. Following block diagram explains the interaction between each component. As usual, we‚Äôll build the system bottom-up.</p><p><img data-proofer-ignore data-src="/assets/img/2021-06-01-23-21-29.png" alt="" /></p><ul id="markdown-toc"><li><a href="#-token-service" id="markdown-toc--token-service">üéü Token Service</a><li><a href="#-token-expiry-strategy" id="markdown-toc--token-expiry-strategy">‚è≤ Token Expiry Strategy</a><li><a href="#-request-manager" id="markdown-toc--request-manager">üëÆ Request Manager</a><li><a href="#-more-on-error-handling" id="markdown-toc--more-on-error-handling">üêû More on error handling</a><li><a href="#-run-it" id="markdown-toc--run-it">üöÄ Run it!</a><li><a href="#-resources" id="markdown-toc--resources">üìñ Resources</a></ul><h2 id="-token-service">üéü Token Service</h2><p>To manage session and expire it, we need meta attributes other than just the token. So, let‚Äôs beef up the token to a data class called SessionToken. This will hold created &amp; last access timestamps in addition to the token itself.</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>
<span class="kd">data class</span> <span class="nc">SessionToken</span><span class="p">(</span>
    <span class="kd">val</span> <span class="py">token</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="kd">val</span> <span class="py">created</span><span class="p">:</span> <span class="nc">OffsetDateTime</span><span class="p">,</span>
    <span class="kd">var</span> <span class="py">lastAccess</span><span class="p">:</span> <span class="nc">OffsetDateTime</span> <span class="p">=</span> <span class="n">created</span>
<span class="p">)</span>

</pre></table></code></div></div><p>Our token service is a simple repository which abstracts CRUD on token. When user login-register, a new token generated and wrapped in <code class="language-plaintext highlighter-rouge">SessionToken</code>. For every web request made, the token updated with last access time. In case user logout or token expired, entry will be deleted.</p><p>Below is our simple implementation ‚Äî we store our mock tokens as usual to keep our focus on expiry. The created time points to <code class="language-plaintext highlighter-rouge">now()</code> i.e we emulate like user logged in at the time of launch.</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre>
<span class="nd">@Service</span>
<span class="kd">class</span> <span class="nc">TokenService</span> <span class="p">{</span>

    <span class="k">private</span> <span class="kd">val</span> <span class="py">store</span> <span class="p">=</span> <span class="n">mutableMapOf</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">,</span> <span class="nc">SessionToken</span><span class="p">&gt;()</span>

    <span class="nf">init</span> <span class="p">{</span>
        <span class="n">store</span><span class="p">[</span><span class="s">"token-buyer"</span><span class="p">]</span> <span class="p">=</span>
            <span class="nc">SessionToken</span><span class="p">(</span><span class="s">"token-buyer"</span><span class="p">,</span> <span class="nc">OffsetDateTime</span><span class="p">.</span><span class="nf">now</span><span class="p">())</span>
        <span class="n">store</span><span class="p">[</span><span class="s">"token-seller"</span><span class="p">]</span> <span class="p">=</span>
            <span class="nc">SessionToken</span><span class="p">(</span><span class="s">"token-seller"</span><span class="p">,</span> <span class="nc">OffsetDateTime</span><span class="p">.</span><span class="nf">now</span><span class="p">())</span>
    <span class="p">}</span>

    <span class="k">fun</span> <span class="nf">createToken</span><span class="p">()</span> <span class="p">=</span> <span class="nc">SessionToken</span><span class="p">(</span>
        <span class="n">token</span> <span class="p">=</span> <span class="nc">UUID</span><span class="p">.</span><span class="nf">randomUUID</span><span class="p">().</span><span class="nf">toString</span><span class="p">(),</span>
        <span class="n">created</span> <span class="p">=</span> <span class="nc">OffsetDateTime</span><span class="p">.</span><span class="nf">now</span><span class="p">()</span>
    <span class="p">)</span>

    <span class="k">fun</span> <span class="nf">peekToken</span><span class="p">(</span><span class="n">token</span><span class="p">:</span> <span class="nc">String</span><span class="p">?):</span> <span class="nc">SessionToken</span><span class="p">?</span> <span class="p">=</span> <span class="n">store</span><span class="p">[</span><span class="n">token</span><span class="p">]</span>

    <span class="k">fun</span> <span class="nf">updateLastAccessTime</span><span class="p">(</span><span class="n">token</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// TODO: Token not found in store - fishy!!</span>
        <span class="n">store</span><span class="p">[</span><span class="n">token</span><span class="p">]</span><span class="o">?.</span><span class="n">lastAccess</span> <span class="p">=</span> <span class="nc">OffsetDateTime</span><span class="p">.</span><span class="nf">now</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="k">fun</span> <span class="nf">deleteToken</span><span class="p">(</span><span class="n">token</span><span class="p">:</span> <span class="nc">String</span><span class="p">?)</span> <span class="p">{</span>
        <span class="n">store</span><span class="p">.</span><span class="nf">remove</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

</pre></table></code></div></div><h2 id="-token-expiry-strategy">‚è≤ Token Expiry Strategy</h2><p>When it comes to expiry, it‚Äôs always a good practice to abstract out the validation part and create functional interface to carry out the validation. This will help us plug-in different implementations in the system with little config change.</p><p>This brings us to a functional interface <code class="language-plaintext highlighter-rouge">SessionExpiryStrategy</code> which takes a <code class="language-plaintext highlighter-rouge">SessionToken</code> validate and return whether it is expired.</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>
<span class="kd">interface</span> <span class="nc">SessionExpiryStrategy</span> <span class="p">{</span>

    <span class="k">fun</span> <span class="nf">isSessionExpired</span><span class="p">(</span><span class="n">token</span><span class="p">:</span> <span class="nc">SessionToken</span><span class="p">):</span> <span class="nc">Boolean</span>

<span class="p">}</span>

</pre></table></code></div></div><p>An implementation is only good when explained with its implementations. We consider three different strategies for this.</p><ol><li>Fixed lifespan : Session will expire after 30 days<li>Timeout : If user is not active for 3 minutes ‚Äî logout<li>Extended Lifespan: If user is active during the 30th day, give him grace period in 3 minute window</ol><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="nd">@Component</span><span class="p">(</span><span class="s">"fixed_time"</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">FixedLifeSpanStrategy</span> <span class="p">:</span> <span class="nc">SessionExpiryStrategy</span> <span class="p">{</span>
    <span class="c1">// 30 days fixed lifespan</span>
    <span class="kd">val</span> <span class="py">MAX_DURATION</span> <span class="p">=</span> <span class="mi">30</span> <span class="p">*</span> <span class="mi">24</span> <span class="p">*</span> <span class="mi">60</span> <span class="p">*</span> <span class="mi">60</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">isSessionExpired</span><span class="p">(</span><span class="n">token</span><span class="p">:</span> <span class="nc">SessionToken</span><span class="p">):</span> <span class="nc">Boolean</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">durationSinceLogin</span> <span class="p">=</span> <span class="nc">ChronoUnit</span><span class="p">.</span><span class="nc">SECONDS</span><span class="p">.</span><span class="nf">between</span><span class="p">(</span>
            <span class="n">token</span><span class="p">.</span><span class="n">created</span><span class="p">,</span>
            <span class="nc">OffsetDateTime</span><span class="p">.</span><span class="nf">now</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">durationSinceLogin</span> <span class="p">&gt;</span> <span class="nc">MAX_DURATION</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="nd">@Component</span><span class="p">(</span><span class="s">"timeout"</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">TimeoutExpiryStrategy</span> <span class="p">:</span> <span class="nc">SessionExpiryStrategy</span> <span class="p">{</span>
    <span class="c1">// Logout after 3 minutes of inactivity</span>
    <span class="k">const</span> <span class="kd">val</span> <span class="py">MAX_DURATION</span> <span class="p">=</span> <span class="mi">3</span> <span class="p">*</span> <span class="mi">60</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">isSessionExpired</span><span class="p">(</span><span class="n">token</span><span class="p">:</span> <span class="nc">SessionToken</span><span class="p">):</span> <span class="nc">Boolean</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">durationSinceLastAccess</span> <span class="p">=</span> <span class="nc">ChronoUnit</span><span class="p">.</span><span class="nc">SECONDS</span><span class="p">.</span><span class="nf">between</span><span class="p">(</span>
            <span class="n">token</span><span class="p">.</span><span class="n">lastAccess</span><span class="p">,</span>
            <span class="nc">OffsetDateTime</span><span class="p">.</span><span class="nf">now</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">durationSinceLastAccess</span> <span class="p">&gt;</span> <span class="nc">MAX_DURATION</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="nd">@Component</span><span class="p">(</span><span class="s">"extended"</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">ExtendedLifeSpanStrategy</span> <span class="p">:</span> <span class="nc">SessionExpiryStrategy</span> <span class="p">{</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">timeoutExpiryStrategy</span> <span class="p">=</span> <span class="nc">TimeoutExpiryStrategy</span><span class="p">()</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">fixedLifeSpanStrategy</span> <span class="p">=</span> <span class="nc">FixedLifeSpanStrategy</span><span class="p">()</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">isSessionExpired</span><span class="p">(</span><span class="n">token</span><span class="p">:</span> <span class="nc">SessionToken</span><span class="p">):</span> <span class="nc">Boolean</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">if</span> <span class="p">(</span><span class="n">fixedLifeSpanStrategy</span><span class="p">.</span><span class="nf">isSessionExpired</span><span class="p">(</span><span class="n">token</span><span class="p">))</span> <span class="p">{</span>
            <span class="c1">// 30 days past, if user is in the mid of something try the timeout</span>
            <span class="c1">// to extend his session</span>
            <span class="n">timeoutExpiryStrategy</span><span class="p">.</span><span class="nf">isSessionExpired</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="c1">// 30 days not past yet Let him use the system</span>
            <span class="k">false</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>Few Usecases:</strong> As you can see in <code class="language-plaintext highlighter-rouge">ExtendedLifeSpanStrategy</code>, we can mix-match the implementations to tailor user experience. Let‚Äôs say the buyer in our e-commerce website actively purchasing something and just before he makes payment, session expire due to 30 day lifespan ‚Äî It would be frustrating. Three minutes added on each api call will alleviate the expiry.</p><p>If we want Seller account to logout on 3 minutes inactivity and a fixed timespan for Buyer, it can be achieved by picking strategy ‚Äòper role‚Äô.</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>
<span class="kd">val</span> <span class="py">strategies</span> <span class="p">=</span> <span class="nf">mapOf</span><span class="p">(</span>
    <span class="nc">BUYER</span> <span class="n">to</span> <span class="n">fixedTimeSpan</span><span class="p">,</span>
    <span class="nc">SELLER</span> <span class="n">to</span> <span class="n">timeoutStrategy</span>
<span class="p">)</span>

<span class="o">..</span><span class="p">.</span>

<span class="n">strategy</span><span class="p">[</span><span class="n">role</span><span class="p">].</span><span class="nf">isSessionExpired</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>

</pre></table></code></div></div><p>We have a strategy and a tokenservice in place ‚Äî let‚Äôs move on to the final piece where we connect both.</p><h2 id="-request-manager">üëÆ Request Manager</h2><p>Before we move on to the logic, let‚Äôs fix the üêû in user service. From now, it will return <code class="language-plaintext highlighter-rouge">null</code> role for unknown/expired tokens. Still, if there is no token present, session will be identified as VISITOR.</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>
    <span class="k">fun</span> <span class="nf">identifyRole</span><span class="p">(</span><span class="n">token</span><span class="p">:</span> <span class="nc">String</span><span class="p">?):</span> <span class="nc">Roles</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">if</span> <span class="p">(</span><span class="n">token</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
            <span class="nc">Roles</span><span class="p">.</span><span class="nc">VISITOR</span>
        <span class="k">else</span>
            <span class="n">role</span><span class="p">[</span><span class="n">token</span><span class="p">]</span>
    <span class="p">}</span>

</pre></table></code></div></div><p>In the request manager, wire the expiry strategy as you see fit. We‚Äôll use qualifiers to inject different strategies that we implemented in last section.</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre>
    <span class="nd">@Autowired</span>
    <span class="nd">@Qualifier</span><span class="p">(</span><span class="s">"timeout"</span><span class="p">)</span>
<span class="c1">//    @Qualifier("extended")</span>
<span class="c1">//    @Qualifier("fixed_time")</span>
    <span class="k">private</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">tokenExpiryStrategy</span><span class="p">:</span> <span class="nc">SessionExpiryStrategy</span>

     <span class="c1">// Save the session info per request. Retrieve it throughout the request</span>
    <span class="k">fun</span> <span class="nf">saveSession</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="nc">HttpServletRequest</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Retrieve auth token from request - if any</span>
        <span class="kd">val</span> <span class="py">token</span><span class="p">:</span> <span class="nc">String</span><span class="p">?</span> <span class="p">=</span> <span class="n">request</span><span class="p">.</span><span class="nf">getHeader</span><span class="p">(</span><span class="nc">HEADER_TOKEN</span><span class="p">)</span>

        <span class="c1">// Identify role</span>
        <span class="kd">val</span> <span class="py">role</span> <span class="p">=</span> <span class="n">userService</span><span class="p">.</span><span class="nf">identifyRole</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">role</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="nf">broadcastTokenWipe</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
            <span class="k">throw</span> <span class="nf">unauthorizedException</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="c1">// Handling users that need a session</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">role</span> <span class="p">!=</span> <span class="nc">Roles</span><span class="p">.</span><span class="nc">VISITOR</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">val</span> <span class="py">sessionToken</span> <span class="p">=</span> <span class="n">tokenService</span><span class="p">.</span><span class="nf">peekToken</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">sessionToken</span> <span class="p">==</span> <span class="k">null</span> <span class="p">||</span> <span class="n">tokenExpiryStrategy</span><span class="p">.</span><span class="nf">isSessionExpired</span><span class="p">(</span><span class="n">sessionToken</span><span class="p">))</span> <span class="p">{</span>
                <span class="nf">broadcastTokenWipe</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
                <span class="k">throw</span> <span class="nf">unauthorizedException</span><span class="p">()</span>
            <span class="p">}</span>

            <span class="c1">// punch-in to the token service</span>
            <span class="n">tokenService</span><span class="p">.</span><span class="nf">updateLastAccessTime</span><span class="p">(</span><span class="n">token</span><span class="o">!!</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="n">request</span><span class="p">.</span><span class="nf">setAttribute</span><span class="p">(</span>
            <span class="nc">KEY_SESSION</span><span class="p">,</span> <span class="nc">DummySession</span><span class="p">(</span>
                <span class="n">role</span> <span class="p">=</span> <span class="n">role</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">}</span>

</pre></table></code></div></div><p>Added inline comments for clarity, again a walkthrough here. If role is null, throw exception. If session token is null or expired for non-VISITORs throw exception. In both cases wipe the token off the system.</p><p>So, what do we throw? ‚Äî 401 response.</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>   <span class="k">private</span> <span class="k">fun</span> <span class="nf">unauthorizedException</span><span class="p">()</span> <span class="p">=</span> <span class="nc">HttpClientErrorException</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span>
        <span class="nc">HttpStatus</span><span class="p">.</span><span class="nc">UNAUTHORIZED</span><span class="p">,</span>
        <span class="s">""</span><span class="p">,</span>
        <span class="nc">HttpHeaders</span><span class="p">.</span><span class="nc">EMPTY</span><span class="p">,</span>
        <span class="nc">ByteArray</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
        <span class="nc">Charsets</span><span class="p">.</span><span class="nc">UTF_8</span>
    <span class="p">)</span>
</pre></table></code></div></div><p>If the session is valid, update the last access time in token service to support <code class="language-plaintext highlighter-rouge">TimeoutStrategy</code>.</p><h2 id="-more-on-error-handling">üêû More on error handling</h2><p>In case, the session is timeout, don‚Äôt let the request proceed further to protect resources. i.e break the chain in request filter.</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre>
<span class="nd">@Component</span>
<span class="kd">class</span> <span class="nc">DummyRequestFilter</span> <span class="p">:</span> <span class="nc">OncePerRequestFilter</span><span class="p">()</span> <span class="p">{</span>

    <span class="nd">@Autowired</span>
    <span class="k">private</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">requestManager</span><span class="p">:</span> <span class="nc">DummyRequestManager</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">doFilterInternal</span><span class="p">(</span>
        <span class="n">request</span><span class="p">:</span> <span class="nc">HttpServletRequest</span><span class="p">,</span>
        <span class="n">response</span><span class="p">:</span> <span class="nc">HttpServletResponse</span><span class="p">,</span>
        <span class="n">filterChain</span><span class="p">:</span> <span class="nc">FilterChain</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="c1">// Feed the request to request manager for session preparation</span>
            <span class="n">requestManager</span><span class="p">.</span><span class="nf">saveSession</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

            <span class="c1">// Resume with request</span>
            <span class="n">filterChain</span><span class="p">.</span><span class="nf">doFilter</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">e</span><span class="p">:</span> <span class="nc">HttpClientErrorException</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">response</span><span class="p">.</span><span class="nf">sendError</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">rawStatusCode</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">statusText</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

</pre></table></code></div></div><p>In dummy request filter, once per request check whether the token is valid. If so, resume the chain, otherwise catch and propogate the 401 error code to the client.</p><p>üêõ That‚Äôs it üêõ</p><h2 id="-run-it">üöÄ Run it!</h2><div class="language-json highlighter-rouge"><div class="code-header"> <span text-data=" Json "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="err">curl</span><span class="w"> </span><span class="err">'http://localhost:</span><span class="mi">8080</span><span class="err">/graphql'</span><span class="w"> </span><span class="err">\</span><span class="w">
  </span><span class="err">-H</span><span class="w"> </span><span class="err">'x-auth-token:</span><span class="w"> </span><span class="err">token-random-one'</span><span class="w"> </span><span class="err">\</span><span class="w">
  </span><span class="err">-H</span><span class="w"> </span><span class="err">'Content-Type:</span><span class="w"> </span><span class="err">application/json'</span><span class="w"> </span><span class="err">\</span><span class="w">
  </span><span class="err">--data-raw</span><span class="w"> </span><span class="err">'</span><span class="p">{</span><span class="nl">"query"</span><span class="p">:</span><span class="s2">"mutation {addProduct}"</span><span class="p">,</span><span class="nl">"variables"</span><span class="p">:</span><span class="kc">null</span><span class="p">}</span><span class="err">'</span><span class="w"> </span><span class="err">\</span><span class="w">
  </span><span class="err">--compressed</span><span class="w">

</span><span class="p">{</span><span class="nl">"timestamp"</span><span class="p">:</span><span class="s2">"2021-06-01T18:28:55.325+00:00"</span><span class="p">,</span><span class="nl">"status"</span><span class="p">:</span><span class="mi">401</span><span class="p">,</span><span class="nl">"error"</span><span class="p">:</span><span class="s2">"Unauthorized"</span><span class="p">,</span><span class="nl">"path"</span><span class="p">:</span><span class="s2">"/graphql"</span><span class="p">}</span><span class="w">

</span><span class="err">curl</span><span class="w"> </span><span class="err">'http://localhost:</span><span class="mi">8080</span><span class="err">/graphql'</span><span class="w"> </span><span class="err">\</span><span class="w">
  </span><span class="err">-H</span><span class="w"> </span><span class="err">'x-auth-token:</span><span class="w"> </span><span class="err">token-seller'</span><span class="w"> </span><span class="err">\</span><span class="w"> 
  </span><span class="err">-H</span><span class="w"> </span><span class="err">'Content-Type:</span><span class="w"> </span><span class="err">application/json'</span><span class="w"> </span><span class="err">\</span><span class="w">
  </span><span class="err">--data-raw</span><span class="w"> </span><span class="err">'</span><span class="p">{</span><span class="nl">"query"</span><span class="p">:</span><span class="s2">"mutation {addProduct}"</span><span class="p">,</span><span class="nl">"variables"</span><span class="p">:</span><span class="kc">null</span><span class="p">}</span><span class="err">'</span><span class="w"> </span><span class="err">\</span><span class="w">
  </span><span class="err">--compressed</span><span class="w">

</span><span class="p">{</span><span class="nl">"data"</span><span class="p">:{</span><span class="nl">"addProduct"</span><span class="p">:</span><span class="s2">"dummy-product-id"</span><span class="p">}}</span><span class="w">

</span></pre></table></code></div></div><h2 id="-resources">üìñ Resources</h2><ol><li><a href="https://github.com/mahendranv/graphql-auth-dummy">Github repo</a><li>GraphQL playground ‚Äî http://localhost:8080/graphiql</ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/graphql/'>GraphQL</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/graphql/" class="post-tag no-text-decoration" >graphql</a> <a href="/tags/springboot/" class="post-tag no-text-decoration" >springboot</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=GraphQL backend ‚Äî token expiry - Mahendran&url=https://mahendranv.github.io/posts/gql-auth-401/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=GraphQL backend ‚Äî token expiry - Mahendran&u=https://mahendranv.github.io/posts/gql-auth-401/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=GraphQL backend ‚Äî token expiry - Mahendran&url=https://mahendranv.github.io/posts/gql-auth-401/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/hilt-instrument/">Android ‚Äî Instrumentation test with hilt</a><li><a href="/posts/hilt-codegen/">Smoke, mirrors & HiltViewModel</a><li><a href="/posts/hilt-viewmodel/">Android ‚Äî Basic Hilt setup with viewmodel + fragment</a><li><a href="/posts/viewmodel-store/">Android ‚Äî ViewModel factory and instantiation</a><li><a href="/posts/compose-shapes-gists/">I created few shapes in Jetpack compose / Gist included</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/kotlin/">kotlin</a> <a class="post-tag" href="/tags/graphql/">graphql</a> <a class="post-tag" href="/tags/springboot/">springboot</a> <a class="post-tag" href="/tags/compose/">compose</a> <a class="post-tag" href="/tags/coding/">coding</a> <a class="post-tag" href="/tags/hilt/">hilt</a> <a class="post-tag" href="/tags/dagger/">dagger</a> <a class="post-tag" href="/tags/dribbble/">dribbble</a> <a class="post-tag" href="/tags/tools/">tools</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/gql-simple-backend/"><div class="card-body"> <span class="timeago small" >May 17, 2021<i class="unloaded">2021-05-17T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>GraphQL - simple backend server - SpringBoot application</h3><div class="text-muted small"><p> In this post, I‚Äôll cover how to create a simple GraphQL server with Springboot and Netflix DGS. DGS is chosen because you start with GraphQL schema and then build server side logic around it. P...</p></div></div></a></div><div class="card"> <a href="/posts/gql-delete-update/"><div class="card-body"> <span class="timeago small" >May 18, 2021<i class="unloaded">2021-05-18T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>GraphQL backend ‚Äî update & delete</h3><div class="text-muted small"><p> In the first installment, I covered create and read operations to the Expense entity. Now let‚Äôs add few more operations ‚á® update and delete queries. Entire source code is available in github. For ...</p></div></div></a></div><div class="card"> <a href="/posts/gql-nested-objects/"><div class="card-body"> <span class="timeago small" >May 20, 2021<i class="unloaded">2021-05-20T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>GraphQL backend ‚Äî nested objects</h3><div class="text-muted small"><p> A nested object is like a Matryoshka doll where one object placed inside another and you can choose to not open the next level ‚Äî a perfect usecase to demonstrate the power of GraphQL. In this post...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/gql-auth/" class="btn btn-outline-primary" prompt="Older"><p>GraphQL backend ‚Äî authorization & authentication</p></a> <a href="/posts/kotlin-flow1/" class="btn btn-outline-primary" prompt="Newer"><p>Flow is non-blocking but the collector is not</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> ¬© 2022 <a href="https://twitter.com/mahevelai">Mahendran Vadivalagan</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/kotlin/">kotlin</a> <a class="post-tag" href="/tags/graphql/">graphql</a> <a class="post-tag" href="/tags/springboot/">springboot</a> <a class="post-tag" href="/tags/compose/">compose</a> <a class="post-tag" href="/tags/coding/">coding</a> <a class="post-tag" href="/tags/hilt/">hilt</a> <a class="post-tag" href="/tags/dagger/">dagger</a> <a class="post-tag" href="/tags/dribbble/">dribbble</a> <a class="post-tag" href="/tags/tools/">tools</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://mahendranv.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
