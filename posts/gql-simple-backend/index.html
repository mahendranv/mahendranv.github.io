<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="GraphQL - simple backend server - SpringBoot application" /><meta property="og:locale" content="en" /><meta name="description" content="A simple SpringBoot application using in memory data source" /><meta property="og:description" content="A simple SpringBoot application using in memory data source" /><link rel="canonical" href="https://mahendranv.github.io/assets/covers/gql_adapter.jpg" /><meta property="og:url" content="https://mahendranv.github.io/assets/covers/gql_adapter.jpg" /><meta property="og:site_name" content="Mahendran" /><meta property="og:image" content="https://i.imgur.com/C1Xt6P8.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-05-17T00:00:00+05:30" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://i.imgur.com/C1Xt6P8.png" /><meta property="twitter:title" content="GraphQL - simple backend server - SpringBoot application" /><meta name="twitter:site" content="@mahevelai" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-06-02T22:38:30+05:30","datePublished":"2021-05-17T00:00:00+05:30","description":"A simple SpringBoot application using in memory data source","headline":"GraphQL - simple backend server - SpringBoot application","image":"https://i.imgur.com/C1Xt6P8.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://mahendranv.github.io/assets/covers/gql_adapter.jpg"},"url":"https://mahendranv.github.io/assets/covers/gql_adapter.jpg"}</script><title>GraphQL - simple backend server - SpringBoot application | Mahendran</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Mahendran"><meta name="application-name" content="Mahendran"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/614333/01be055d-c668-46ba-8f7b-54065256c70d.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Mahendran</a></div><div class="site-subtitle font-italic">Android | Kotlin | Springboot | DGS</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/series/" class="nav-link"> <i class="fa-fw fas fas fa-list-ol ml-xl-3 mr-xl-3 unloaded"></i> <span>SERIES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/mahendranv" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/mahevelai" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://dev.to/mahendranv" aria-label="dev.to" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-dev"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>GraphQL - simple backend server - SpringBoot application</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>GraphQL - simple backend server - SpringBoot application</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Mahendran Vadivalagan </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, May 17, 2021, 12:00 AM +0530" >May 17, 2021<i class="unloaded">2021-05-17T00:00:00+05:30</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Wed, Jun 2, 2021, 10:38 PM +0530" >Jun 2, 2021<i class="unloaded">2021-06-02T22:38:30+05:30</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1165 words">6 min read</span></div></div><div class="post-content"><p>In this post, I’ll cover how to create a simple GraphQL server with Springboot and Netflix DGS. DGS is chosen because you start with GraphQL schema and then build server side logic around it.</p><ul id="markdown-toc"><li><a href="#prerequisite" id="markdown-toc-prerequisite">Prerequisite</a><li><a href="#initial-setup" id="markdown-toc-initial-setup">Initial setup</a><li><a href="#know-the-project-structure" id="markdown-toc-know-the-project-structure">Know the project structure</a><li><a href="#how-to-run-the-project" id="markdown-toc-how-to-run-the-project">How to run the project?</a><li><a href="#coding" id="markdown-toc-coding">Coding</a><ul><li><a href="#netflix-dgs-framework-setup" id="markdown-toc-netflix-dgs-framework-setup">Netflix DGS framework setup</a><li><a href="#graphql-schema-setup" id="markdown-toc-graphql-schema-setup">GraphQL schema setup</a><li><a href="#mapping-java-model-to-the-schema" id="markdown-toc-mapping-java-model-to-the-schema">Mapping java model to the schema</a><li><a href="#graphiql-playground" id="markdown-toc-graphiql-playground">GraphiQL playground</a><li><a href="#adding-a-mutation" id="markdown-toc-adding-a-mutation">Adding a mutation</a></ul><li><a href="#accessing-the-graphql-endpoint-in-client-apps-and-insomnia--postman" id="markdown-toc-accessing-the-graphql-endpoint-in-client-apps-and-insomnia--postman">Accessing the GraphQL endpoint in client apps and Insomnia / Postman</a><li><a href="#source-code" id="markdown-toc-source-code">Source code</a><li><a href="#endnote" id="markdown-toc-endnote">Endnote</a></ul><h2 id="prerequisite">Prerequisite</h2><ul><li><p>Intellij IDEA</p><li><p>GraphQL JS plugin</p><li><p><a href="https://plugins.jetbrains.com/plugin/10942-kotlin-fill-class">Kotlin fill class plugin</a> - optional</p></ul><hr /><h2 id="initial-setup">Initial setup</h2><p>To start with SpringBoot https://start.spring.io/ has set of templates</p><p>For springboot project, headover to https://start.spring.io/ and add <em>Spring Web</em> dependency. Select — Kotlin, jar, Java 11 as project base in lefet pane. Hit Generate button and extract the downloaded zip to a project folder.</p><p><img data-proofer-ignore data-src="https://i.imgur.com/oZRPpFm.png" alt="image-20210517200554913" style="zoom:50%;" /></p><hr /><h2 id="know-the-project-structure">Know the project structure</h2><p>Our application is a single module project in the below tree format. Now it has bare minimum classes to just start the server.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>├─build.gradle.kts
├─gradle
│  └─ wrapper
│      ├─ gradle-wrapper.jar
│      └─ gradle-wrapper.properties
├─gradlew
├─gradlew.bat
├─settings.gradle.kts
└─src
   ├─ main
   │   ├─ kotlin
   │   │   └─ com.ex2.gql.expense   //package
   │   │        └─ ExpenseApplication.kt
   │   └─ resources
   │       ├─ application.properties
   │       ├─ static
   │       └─ templates
   └─ test
       └─ kotlin
           └─ com.ex2.gql.expense
                └─ ExpenseApplicationTests.kt
</pre></table></code></div></div><p><em>fig. Springboot - initial project structure</em></p><p>Know about few files from the project structure.</p><ol><li><code class="language-plaintext highlighter-rouge">build.gralde.kts</code> - is where we add our project dependencies [database / logger / graphql]<li><code class="language-plaintext highlighter-rouge">ExpenseApplication.kt</code> is the starting point of our application. Java <code class="language-plaintext highlighter-rouge">main</code> method is placed here<li>Files and folders of name <code class="language-plaintext highlighter-rouge">gradle*</code> are present here to build our app<li><code class="language-plaintext highlighter-rouge">resources</code> directory is where we place out graphql schemas<li><code class="language-plaintext highlighter-rouge">src/main/kotlin</code> is we actually code our business logic</ol><hr /><h2 id="how-to-run-the-project">How to run the project?</h2><p>Start terminal at the project root and run.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>
./gradlew bootRun

</pre></table></code></div></div><p>— or —</p><p>For development, we’ll use Intellij. So, select the <code class="language-plaintext highlighter-rouge">bootRun</code> gradle task in the gradle tool window and start.</p><p><img data-proofer-ignore data-src="https://i.imgur.com/KFHlW0l.png" alt="image-20210517213150720" style="zoom:56%;" /></p><p>On both cases, gradle wrapper will download all the dependencies (including the gradle distribution itself), and then start the application.</p><h2 id="coding">Coding</h2><h3 id="netflix-dgs-framework-setup">Netflix DGS framework setup</h3><p>Netflix has released the dgs framework as open source on 2020. It powers the netflix API layer for over an year now. DGS plugin is available in mavencentral for us to use - Add the below dependency to your project.</p><div class="language-groovy highlighter-rouge"><div class="code-header"> <span text-data=" Groovy "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>
<span class="c1">// https://mvnrepository.com/artifact/com.netflix.graphql.dgs/graphql-dgs-spring-boot-starter</span>
	<span class="n">implementation</span><span class="o">(</span><span class="s2">"com.netflix.graphql.dgs:graphql-dgs-spring-boot-starter:3.12.1"</span><span class="o">)</span>

</pre></table></code></div></div><p>This plugin provides set of annotations that will connect our data fetchers / queries to our main application <code class="language-plaintext highlighter-rouge">ExpenseApplication</code> and generates <code class="language-plaintext highlighter-rouge">graphiql</code> playground for us to play around with our data.</p><h3 id="graphql-schema-setup">GraphQL schema setup</h3><p><code class="language-plaintext highlighter-rouge">schema</code> is the contract between client and server. DGS is a schema first framework. i.e we define a schema and DGS generate model classes for us. Let’s start by creating a schema file in resource directory.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>
└─resources
    ├─ application.properties
    ├─ schema
    │   └─ schema.graphqls
    ├─ static
    └─ templates

</pre></table></code></div></div><p>Create file <code class="language-plaintext highlighter-rouge">schema.graphqls</code> in the <code class="language-plaintext highlighter-rouge">resources/schema</code> directory. And define an operation and a data model as below.</p><div class="language-graphql highlighter-rouge"><div class="code-header"> <span text-data=" GraphQL "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="w">
</span><span class="k">type</span><span class="w"> </span><span class="n">Query</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">expenses</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="n">Expense</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="k">type</span><span class="w"> </span><span class="n">Expense</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="nb">ID</span><span class="w">
    </span><span class="n">remarks</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="w">
    </span><span class="n">amount</span><span class="p">:</span><span class="w"> </span><span class="nb">Int</span><span class="w">
    </span><span class="n">isIncome</span><span class="p">:</span><span class="w"> </span><span class="nb">Boolean</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></pre></table></code></div></div><h3 id="mapping-java-model-to-the-schema">Mapping java model to the schema</h3><p>To get basic understanding on how model/entity is connected to the schema, Let’s create a data class for <code class="language-plaintext highlighter-rouge">Expense</code> and corresponding fetcher. Fetchers are the helper classes that acts as an adapter between schema and data model.</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="c1">//File:"ExpenseDataFetcher.kt"</span>

<span class="nd">@DgsComponent</span>
<span class="kd">class</span> <span class="nc">ExpenseDataFetcher</span> <span class="p">{</span>

    <span class="k">private</span> <span class="kd">val</span> <span class="py">expenses</span> <span class="p">=</span> <span class="nf">mutableListOf</span><span class="p">(</span>
        <span class="nc">Expense</span><span class="p">(</span><span class="n">id</span> <span class="p">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">amount</span> <span class="p">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">remarks</span> <span class="p">=</span> <span class="s">"Expense 1"</span><span class="p">,</span> <span class="n">isIncome</span> <span class="p">=</span> <span class="k">false</span><span class="p">),</span>
        <span class="nc">Expense</span><span class="p">(</span><span class="n">id</span> <span class="p">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">amount</span> <span class="p">=</span> <span class="mi">120</span><span class="p">,</span> <span class="n">remarks</span> <span class="p">=</span> <span class="s">"Expense 2"</span><span class="p">,</span> <span class="n">isIncome</span> <span class="p">=</span> <span class="k">false</span><span class="p">),</span>
        <span class="nc">Expense</span><span class="p">(</span><span class="n">id</span> <span class="p">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">amount</span> <span class="p">=</span> <span class="mi">110</span><span class="p">,</span> <span class="n">remarks</span> <span class="p">=</span> <span class="s">"Income 3"</span><span class="p">,</span> <span class="n">isIncome</span> <span class="p">=</span> <span class="k">false</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="nd">@DgsQuery</span>
    <span class="k">fun</span> <span class="nf">expenses</span><span class="p">():</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">Expense</span><span class="p">&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">expenses</span>
    <span class="p">}</span>


    <span class="kd">data class</span> <span class="nc">Expense</span><span class="p">(</span>
        <span class="kd">val</span> <span class="py">id</span><span class="p">:</span> <span class="nc">Int</span><span class="p">,</span>
        <span class="kd">val</span> <span class="py">amount</span><span class="p">:</span> <span class="nc">Int</span><span class="p">,</span>
        <span class="kd">val</span> <span class="py">remarks</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
        <span class="kd">val</span> <span class="py">isIncome</span><span class="p">:</span> <span class="nc">Boolean</span>
    <span class="p">)</span>
<span class="p">}</span>

</pre></table></code></div></div><p><strong>Tips:</strong> To fill in the data class, you can use the Fill data class plugin. It can generate default values for all the parameters. Inside the Expenses block invoke suggestions by <code class="language-plaintext highlighter-rouge">Alt(Option) + Return(Enter)</code> key.</p><p><img data-proofer-ignore data-src="https://i.imgur.com/rPEWs02.png" alt="image-20210517221425546" style="zoom:70%;" /></p><p>That’s it!!</p><p>Now we have a working setup of a GraphQL query to play with. Annotations <code class="language-plaintext highlighter-rouge">DgsQuery</code> and <code class="language-plaintext highlighter-rouge">DgsComponent</code> will connect our model to the schema and register our component with main application.</p><h3 id="graphiql-playground">GraphiQL playground</h3><p>Now run the application and visit http://localhost:8080/graphiql. You should see the GraphiQL page — A visual tool where you construct your queries and verify the fetcher.</p><div class="language-graphql highlighter-rouge"><div class="code-header"> <span text-data=" GraphQL "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="w">
</span><span class="k">query</span><span class="w"> </span><span class="n">MyQuery</span><span class="w"> </span><span class="p">{</span><span class="w"> 
  </span><span class="n">expenses</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">amount</span><span class="w">
    </span><span class="n">remarks</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p><img data-proofer-ignore data-src="https://i.imgur.com/LWg6gLp.png" alt="image-20210517223413283" style="zoom:50%;" /></p><p class="figcaption">Query call to the server</p><hr /><h3 id="adding-a-mutation">Adding a mutation</h3><p>To add a mutation, head over to the schema file and add input type and a mutation for expense.</p><div class="language-graphql highlighter-rouge"><div class="code-header"> <span text-data=" GraphQL "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="w">
</span><span class="k">type</span><span class="w"> </span><span class="n">Mutation</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">createExpense</span><span class="p">(</span><span class="n">data</span><span class="p">:</span><span class="w"> </span><span class="n">ExpenseInput</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Expense</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="k">input</span><span class="w"> </span><span class="n">ExpenseInput</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">remarks</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="w">
    </span><span class="n">amount</span><span class="p">:</span><span class="w"> </span><span class="nb">Int</span><span class="w">
    </span><span class="n">isIncome</span><span class="p">:</span><span class="w"> </span><span class="nb">Boolean</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></pre></table></code></div></div><p>Add a bit of code to insert an element into the list. Give matching names and a method to create field [auto generated id]. And an annotation to connect function to the mutation query.</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="c1">//File:"ExpenseDataFetcher.kt"</span>

  <span class="k">private</span> <span class="kd">val</span> <span class="py">random</span> <span class="p">=</span> <span class="nc">Random</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
  <span class="k">private</span> <span class="k">fun</span> <span class="nf">randomInt</span><span class="p">()</span> <span class="p">=</span> <span class="n">random</span><span class="p">.</span><span class="nf">nextInt</span><span class="p">()</span>

  <span class="nd">@DgsMutation</span>
  <span class="k">fun</span> <span class="nf">createExpense</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nc">ExpenseInput</span><span class="p">):</span> <span class="nc">Expense</span> <span class="p">{</span>
      <span class="kd">val</span> <span class="py">expense</span> <span class="p">=</span> <span class="nc">Expense</span><span class="p">(</span>
          <span class="n">id</span> <span class="p">=</span> <span class="nf">randomInt</span><span class="p">(),</span>
          <span class="n">amount</span> <span class="p">=</span> <span class="n">data</span><span class="p">.</span><span class="n">amount</span><span class="p">,</span>
          <span class="n">remarks</span> <span class="p">=</span> <span class="n">data</span><span class="p">.</span><span class="n">remarks</span><span class="p">,</span>
          <span class="n">isIncome</span> <span class="p">=</span> <span class="n">data</span><span class="p">.</span><span class="n">isIncome</span><span class="p">,</span>
      <span class="p">)</span>
      <span class="n">expenses</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">expense</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">expense</span>
  <span class="p">}</span>

  <span class="kd">data class</span> <span class="nc">ExpenseInput</span><span class="p">(</span>
      <span class="kd">val</span> <span class="py">amount</span><span class="p">:</span> <span class="nc">Int</span><span class="p">,</span>
      <span class="kd">val</span> <span class="py">remarks</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
      <span class="kd">val</span> <span class="py">isIncome</span><span class="p">:</span> <span class="nc">Boolean</span>
  <span class="p">)</span>

</pre></table></code></div></div><p>Now try the mutation in GraphiQL playground. You should see the new Expense object is returned. Verify the entry added to the list by again running <code class="language-plaintext highlighter-rouge">MyQuery </code> in the playground.</p><div class="language-graphql highlighter-rouge"><div class="code-header"> <span text-data=" GraphQL "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="w">
</span><span class="k">mutation</span><span class="w"> </span><span class="n">MyMutation</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">createExpense</span><span class="p">(</span><span class="n">data</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="n">remarks</span><span class="p">:</span><span class="w"> </span><span class="s2">"From GraphiQL"</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="n">isIncome</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">})</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">id</span><span class="w">
    </span><span class="n">remarks</span><span class="w">
    </span><span class="n">amount</span><span class="w">
    </span><span class="n">isIncome</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></pre></table></code></div></div><p><img data-proofer-ignore data-src="https://i.imgur.com/BcADY41.png" alt="image-20210517231344271" class="lead" loading="lazy" /></p><p class="figcaption">Mutation call to the server</p><p>…</p><hr /><h2 id="accessing-the-graphql-endpoint-in-client-apps-and-insomnia--postman">Accessing the GraphQL endpoint in client apps and Insomnia / Postman</h2><p>If you’re fond of a REST/GraphQL client or to use the API in your client already, use the following endpoint.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>
// Endpoint for Client
http://localhost:8080/graphql

// GraphiQL playground 
http://localhost:8080/graphiql

</pre></table></code></div></div><blockquote><p>Note there is no <code class="language-plaintext highlighter-rouge">i</code> in endpoint.</p></blockquote><p><img data-proofer-ignore data-src="https://i.imgur.com/sNUqmuh.png" alt="image-20210517235204232" /></p><p class="figcaption">GraphQL query in Insomnia</p><hr /><h2 id="source-code">Source code</h2><p>Entire source code is available in <a href="https://github.com/mahendranv/spring-expenses">Github</a>.</p><hr /><h2 id="endnote">Endnote</h2><p>This the the bare minimum setup to make Create / Read requests to the backend using GraphQL. It is a steep learning curve to write queries for nested objects and connecting to a persistent database. Also there are other components available in DGS framework for codegen and custom scalars. I’ll explore and add each usecase to this series.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/graphql/'>GraphQL</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/graphql/" class="post-tag no-text-decoration" >graphql</a> <a href="/tags/springboot/" class="post-tag no-text-decoration" >springboot</a> <a href="/tags/kotlin/" class="post-tag no-text-decoration" >kotlin</a> <a href="/tags/beginners/" class="post-tag no-text-decoration" >beginners</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=GraphQL - simple backend server - SpringBoot application - Mahendran&url=https://mahendranv.github.io/posts/gql-simple-backend/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=GraphQL - simple backend server - SpringBoot application - Mahendran&u=https://mahendranv.github.io/posts/gql-simple-backend/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=GraphQL - simple backend server - SpringBoot application - Mahendran&url=https://mahendranv.github.io/posts/gql-simple-backend/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/hilt-instrument/">Android — Instrumentation test with hilt</a><li><a href="/posts/hilt-codegen/">Smoke, mirrors & HiltViewModel</a><li><a href="/posts/hilt-viewmodel/">Android — Basic Hilt setup with viewmodel + fragment</a><li><a href="/posts/viewmodel-store/">Android — ViewModel factory and instantiation</a><li><a href="/posts/compose-shapes-gists/">I created few shapes in Jetpack compose / Gist included</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/kotlin/">kotlin</a> <a class="post-tag" href="/tags/graphql/">graphql</a> <a class="post-tag" href="/tags/springboot/">springboot</a> <a class="post-tag" href="/tags/compose/">compose</a> <a class="post-tag" href="/tags/coding/">coding</a> <a class="post-tag" href="/tags/hilt/">hilt</a> <a class="post-tag" href="/tags/dagger/">dagger</a> <a class="post-tag" href="/tags/dribbble/">dribbble</a> <a class="post-tag" href="/tags/tools/">tools</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/gql-delete-update/"><div class="card-body"> <span class="timeago small" >May 18, 2021<i class="unloaded">2021-05-18T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>GraphQL backend — update & delete</h3><div class="text-muted small"><p> In the first installment, I covered create and read operations to the Expense entity. Now let’s add few more operations ⇨ update and delete queries. Entire source code is available in github. For ...</p></div></div></a></div><div class="card"> <a href="/posts/gql-nested-objects/"><div class="card-body"> <span class="timeago small" >May 20, 2021<i class="unloaded">2021-05-20T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>GraphQL backend — nested objects</h3><div class="text-muted small"><p> A nested object is like a Matryoshka doll where one object placed inside another and you can choose to not open the next level — a perfect usecase to demonstrate the power of GraphQL. In this post...</p></div></div></a></div><div class="card"> <a href="/posts/gql-data-loaders/"><div class="card-body"> <span class="timeago small" >May 21, 2021<i class="unloaded">2021-05-21T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>GraphQL backend — data loaders</h3><div class="text-muted small"><p> In the previous post, I created a FatExpense object and added manual checks to avoid fetching Account entity. If we’re scanning the selection manually and write our own check, what’s the role of Gr...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/graphql-date-conversion/" class="btn btn-outline-primary" prompt="Older"><p>Get productive with GraphQL — Type Adapters</p></a> <a href="/posts/gql-delete-update/" class="btn btn-outline-primary" prompt="Newer"><p>GraphQL backend — update & delete</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/mahevelai">Mahendran Vadivalagan</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/kotlin/">kotlin</a> <a class="post-tag" href="/tags/graphql/">graphql</a> <a class="post-tag" href="/tags/springboot/">springboot</a> <a class="post-tag" href="/tags/compose/">compose</a> <a class="post-tag" href="/tags/coding/">coding</a> <a class="post-tag" href="/tags/hilt/">hilt</a> <a class="post-tag" href="/tags/dagger/">dagger</a> <a class="post-tag" href="/tags/dribbble/">dribbble</a> <a class="post-tag" href="/tags/tools/">tools</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://mahendranv.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
